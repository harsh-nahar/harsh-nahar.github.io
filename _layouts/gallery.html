---
layout: default
---

<div class="full-bg">
  <div class="container post-container">
    <div class="gallery-header">
      <a href="{{ '/gallery/' | relative_url }}" class="back-link">&lt; gallery</a>
      <button id="fontSwitch" class="font-switch">default</button>
    </div>

    <article class="post-content">
      <h1>{{ page.title }}</h1>

      {% if page.description %}
        <p class="desc">{{ page.description }}</p>
      {% endif %}

      <!-- Masonry container -->
      <div class="gallery-images" id="macy-container">
        {{ content }}
      </div>
    </article>

    <button id="shareBtn" class="share-btn">🔗 share</button>
  </div>
</div>

<!-- ---------- Libraries ---------- -->
<!-- Macy (Masonry Grid) -->
<script src="https://cdn.jsdelivr.net/npm/macy@2.5.1/dist/macy.min.js"></script>

<!-- LightGallery (Lightbox) -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/lightgallery@2.8.2/css/lightgallery-bundle.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/lightgallery@2.8.2/lightgallery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lightgallery@2.8.2/plugins/zoom/lg-zoom.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lightgallery@2.8.2/plugins/thumbnail/lg-thumbnail.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  /* ---------- Share button ---------- */
  const shareBtn = document.getElementById("shareBtn");
  shareBtn.addEventListener("click", async () => {
    const url = window.location.href;
    if (navigator.share && /Mobi|Tablet|iPad|iPhone/.test(navigator.userAgent)) {
      navigator.share({ url });
    } else {
      await navigator.clipboard.writeText(url);
      shareBtn.textContent = "✔️ copied";
      setTimeout(() => (shareBtn.textContent = "🔗 share"), 2000);
    }
  });

  /* ---------- Font toggle ---------- */
  const fontBtn = document.getElementById("fontSwitch");
  fontBtn.addEventListener("click", () => {
    if (fontBtn.textContent === "default") {
      document.body.style.fontFamily = "sans-serif";
      fontBtn.textContent = "sans-serif";
    } else {
      document.body.style.fontFamily = "'Cormorant Garamond', serif";
      fontBtn.textContent = "default";
    }
  });

  /* ---------- Wrap all Markdown images for LightGallery ---------- */
  const galleryContainer = document.querySelector("#macy-container");
  const imgs = galleryContainer.querySelectorAll("img");
  imgs.forEach((img) => {
    if (!img.closest("a")) {
      const wrapper = document.createElement("a");
      wrapper.href = img.src;
      wrapper.classList.add("gallery-item");
      img.parentNode.insertBefore(wrapper, img);
      wrapper.appendChild(img);
    }
  });

  /* ---------- Initialize LightGallery ---------- */
  lightGallery(galleryContainer, {
    selector: ".gallery-item",
    zoom: true,
    thumbnail: true,
    download: false,
    closable: true,
  });

  /* ---------- Initialize Macy (Masonry) ---------- */
  const macyInstance = Macy({
    container: "#macy-container",
    trueOrder: false,
    waitForImages: true,
    margin: 16,
    columns: 3,
    breakAt: {
      1024: 2,
      768: 1,
    },
  });

  // Recalculate after all images have loaded
  window.addEventListener("load", () => {
    macyInstance.runOnImageLoad(() => macyInstance.recalculate(true), true);
  });
});
</script>

<style>
/* ---------- Masonry & Image Styles ---------- */
.gallery-images {
  margin-top: 1.5rem;
}
.gallery-images a {
  display: block;
  overflow: hidden;
  border-radius: 0;
}
.gallery-images img {
  width: 100%;
  height: auto;
  display: block;
  transition: transform 0.25s ease;
  cursor: pointer;
}
.gallery-images img:hover {
  transform: scale(1.03);
}

/* ---------- Description Text ---------- */
.desc {
  color: #555;
  margin-bottom: 1.5rem;
  font-size: 1rem;
  line-height: 1.6;
}

/* ---------- LightGallery Backdrop ---------- */
.lg-backdrop {
  background: rgba(0, 0, 0, 0.9);
}

/* ---------- Small UI Polishes ---------- */
.gallery-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 720px;
  margin: 0 auto 1.5rem;
  padding: 0 1rem;
}
.gallery-header .back-link {
  font-size: 1.2rem;
  color: #555;
  text-decoration: none;
}
.gallery-header .back-link:hover {
  color: #000;
}
.gallery-header .font-switch {
  font-size: 0.95rem;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: transparent;
  padding: 0.25rem 0.6rem;
  cursor: pointer;
}
</style>
