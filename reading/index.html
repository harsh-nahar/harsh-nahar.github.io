---
layout: default
title: "reading log"
permalink: /reading/
description: "a chronological log of books and essays i have read."
image: "https://cdn.jsdelivr.net/gh/harsh-nahar/assets@main/blog-assets/dark_bookshelf.webp"
---

<!-- 
    ========================================
    1. STYLESHEET
    Contains specific overrides for the Dashboard, Chart, and Lists.
    Relies on Tailwind for layout, but custom CSS for specific components.
    ========================================
-->
    
<style>
    /* --- DASHBOARD CONTAINER --- */
    .stat-card {
        padding: 24px; /* Standard comfortable padding */
        border: 1px solid #e5e7eb;
        border-radius: 16px;
        background: #fff;
        margin-bottom: 32px;
    }
    .dark .stat-card { background: #1c1c1e; border-color: #333; }

    /* Stats Typography */
    .stat-label { font-size: 0.75rem; text-transform: uppercase; color: #9ca3af; letter-spacing: 0.05em; margin-bottom: 4px; }
    .stat-val { font-family: 'JetBrains Mono', monospace; font-weight: 700; color: #1d1d1f; line-height: 1.2; }
    .dark .stat-val { color: #fff; }

    /* --- CHART VISUALIZER --- */
    .chart-container {
        display: flex;
        flex-direction: column;
        gap: 10px;
        height: auto;
        padding: 0;
    }

    .bar-group {
        display: grid;
        grid-template-columns: 32px 1fr 24px;
        align-items: center;
        gap: 10px;
    }

    .bar-track {
        width: 100%;
        height: 8px;
        background: transparent;
    }

    .bar {
        height: 100%;
        background-color: #e5e7eb !important;
        border-radius: 4px;
        transition: width 0.4s ease;
    }

    .bar.active-year {
        background-color: #1d1d1f !important;
    }

    .dark .bar {
        background-color: #3f3f46 !important;
    }

    .dark .bar.active-year {
        background-color: #fff !important;
    }

    .bar-label {
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.65rem;
        color: #9ca3af;
        text-align: right;
    }

    .bar-val {
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.7rem;
        font-weight: 700;
        color: #1d1d1f;
        text-align: right;
    }
    /* Show number on hover OR if it's the current year */
    .bar-group:hover .bar-val, .bar-group:active .bar-val { opacity: 1; }
    .dark .bar-val { color: #fff; }

    /* --- TABS & LISTS --- */
    .tab-bar { display: flex; gap: 20px; border-bottom: 1px solid #e5e7eb; margin-bottom: 30px; }
    .dark .tab-bar { border-color: #333; }
    .tab-btn { padding-bottom: 10px; font-size: 0.9rem; font-weight: 500; color: #9ca3af; cursor: pointer; border-bottom: 2px solid transparent; margin-bottom: -1px; }
    .tab-btn.active { color: #1d1d1f; border-bottom-color: #1d1d1f; }
    .dark .tab-btn.active { color: #fff; border-bottom-color: #fff; }

    .list-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; font-size: 0.75rem; color: #9ca3af; text-transform: uppercase; letter-spacing: 0.05em; }
    
    .item-row { display: flex; justify-content: space-between; align-items: baseline; padding: 12px 0; border-bottom: 1px dashed #f3f4f6; transition: opacity 0.2s; }
    .dark .item-row { border-color: #27272a; }
    .item-row:hover { opacity: 0.7; }
    .item-row.hidden { display: none !important; }
    
    @media (min-width: 640px) {
        .item-left { display: block; }
        .item-author::before { content: " "; margin-left: 6px; }
    }
    .item-left { display: flex; flex-direction: column; gap: 2px; max-width: 80%; }

    .item-title { font-weight: 600; color: #1d1d1f; font-size: 1rem; }
    .dark .item-title { color: #fff; }
    .item-author { font-size: 0.85rem; color: #6b7280; font-weight: 400; }
    .item-meta { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: #9ca3af; white-space: nowrap; }

    .tag-pill { display: inline-block; font-family: 'JetBrains Mono', monospace; font-size: 0.6rem; padding: 1px 6px; border: 1px solid #f3f4f6; border-radius: 4px; color: #4b5563; margin-left: 6px; cursor: pointer; transition: all 0.2s ease; }
    .tag-pill:hover { background: #e5e7eb; color: #1d1d1f; }
    .dark .tag-pill { border-color: #333; color: #6b7280; }
    .dark .tag-pill:hover { background: #4b5563; color: #fff; }

    .filter-active-badge { display: inline-flex; align-items: center; gap: 6px; background: #1d1d1f; color: #fff; padding: 4px 12px; border-radius: 99px; font-size: 0.75rem; cursor: pointer; font-family: 'JetBrains Mono', monospace; }
    .dark .filter-active-badge { background: #fff; color: #000; }
    
    .stars { letter-spacing: 2px; }
    .star-fill { color: #1d1d1f; } .star-empty { color: #e5e7eb; }
    .dark .star-fill { color: #fff; } .dark .star-empty { color: #333; }
    .sort-toggle { cursor: pointer; display: flex; align-items: center; gap: 4px; }
    .sort-toggle:hover { color: #1d1d1f; } .dark .sort-toggle:hover { color: #fff; }

    details { border-bottom: 1px solid #f3f4f6; margin-bottom: 0; }
    .dark details { border-color: #27272a; }
    details > summary { list-style: none; outline: none; }
    details > summary::-webkit-details-marker { display: none; }
    .year-summary { display: flex; justify-content: space-between; align-items: center; padding: 24px 0; cursor: pointer; font-family: 'JetBrains Mono', monospace; color: #1d1d1f; transition: opacity 0.2s; }
    .dark .year-summary { color: #fff; }
    .year-summary:hover { opacity: 0.7; }
    .year-text { font-size: 1.25rem; font-weight: 700; }
    .year-count { font-size: 0.75rem; background: #f3f4f6; color: #6b7280; padding: 2px 8px; border-radius: 99px; margin-left: 10px; font-weight: 600; }
    .dark .year-count { background: #333; color: #9ca3af; }
    .chevron { transition: transform 0.2s; color: #9ca3af; }
    details[open] .chevron { transform: rotate(180deg); }
    details[open] > .group-content { animation: slideDown 0.25s ease-out; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
</style>


<!-- 
    ========================================
    2. MAIN CONTENT AREA
    ========================================
-->
<div class="fade-in max-w-3xl mx-auto mb-20">

    <!-- Page Title -->
    <div class="mb-10">
        <h1 class="text-3xl font-bold text-[#1d1d1f] dark:text-white mb-2">reading log</h1>
        <p class="text-sm text-gray-500 dark:text-gray-400">a chronological log of books and essays i have read.</p>
    </div>

    <!-- 
        STATS DASHBOARD 
        Split into Left (Metrics) and Right (Chart)
    -->
    <div class="stat-card">
        <!-- Grid: 2 columns even on mobile (side-by-side) -->
        <div class="grid grid-cols-2 gap-4 sm:gap-8 h-full">
            
            <!-- LEFT COLUMN: Key Metrics -->
            <div class="flex flex-col justify-between">
                <!-- Top: Total Count -->
                <div class="mb-4 sm:mb-0">
                    <p class="stat-label">Total Books</p>
                    <div class="stat-val text-3xl sm:text-4xl">{{ site.data.books.size }}</div>
                </div>

                <!-- Bottom: Secondary Stats (Current Year + Avg Rating) -->
                <div class="flex flex-row gap-8">
                    <div>
                        <p class="stat-label">This Year</p>
                        <div class="stat-val text-lg sm:text-xl" id="statCurrentYear">0</div>
                    </div>
                    <div>
                        <p class="stat-label">Avg Rating</p>
                        <div class="stat-val text-lg sm:text-xl" id="statAvgRating">0.0</div>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN: Bar Chart Container -->
            <div class="border-l border-dashed border-gray-200 dark:border-gray-800 pl-4 sm:pl-8">
                <!-- The JS will inject HTML bars into this ID -->
                <div id="readingChart" class="chart-container"></div>
            </div>
            
        </div>
    </div>

    <!-- TABS -->
    <div class="tab-bar">
        <div class="tab-btn active" onclick="switchTab('books')">Books</div>
        <div class="tab-btn" onclick="switchTab('essays')">Essays</div>
    </div>

    <!-- 
        ========================================
        3. BOOKS VIEW (Default)
        Uses Jekyll Liquid to group and render books
        ========================================
    -->
    <div id="viewBooks">
        <!-- Header with Sort Toggle -->
        <div class="list-header">
            <span>Title / Author</span>
            <span class="sort-toggle" onclick="toggleSort()">
                <span id="sortLabel">Newest First</span> <i data-lucide="arrow-up-down" class="w-3 h-3"></i>
            </span>
        </div>

        <!-- FILTER STATUS (Hidden by default) -->
         <div id="filterStatus" class="mb-6 hidden fade-in">
            <div class="filter-active-badge" onclick="clearFilter()">
                <span id="filterLabel">tag</span>
                <span id="filterCount" class="opacity-60 ml-1 text-xs"></span>
                <i data-lucide="x" class="w-3 h-3"></i>
            </div>
        </div>

        <div id="bookListContainer">
            
            {% comment %} --- LIQUID DATA PROCESSING --- {% endcomment %}
            {% assign all_books = site.data.books %}
            
            {% comment %} 1. Separate Dated and Undated books {% endcomment %}
            {% assign dated_books = all_books | where_exp: "item", "item.date_read != '' and item.date_read != nil" %}
            {% assign undated_books = all_books | where_exp: "item", "item.date_read == '' or item.date_read == nil" %}
            
            {% comment %} 2. Group Dated books by Year (Descending) {% endcomment %}
            {% assign grouped_books = dated_books | group_by_exp: "item", "item.date_read | date: '%Y'" | sort: 'name' | reverse %}


            {% comment %} --- LOOP 1: YEARLY GROUPS --- {% endcomment %}
            {% for group in grouped_books %}
                <details class="year-group" {% if forloop.first %}open{% endif %}>
                    <summary class="year-summary">
                        <div>
                            <span class="year-text">{{ group.name }}</span>
                            <span class="year-count">{{ group.items.size }}</span>
                        </div>
                        <i data-lucide="chevron-down" class="chevron w-5 h-5"></i>
                    </summary>
                    
                    <div class="group-content">
                        {% assign sorted_items = group.items | sort: 'date_read' | reverse %}
                        {% for book in sorted_items %}
                            <!-- Single Book Row -->
                            <div class="item-row book-entry" data-date="{{ book.date_read }}" data-rating="{{ book.rating }}" data-tags="{{ book.tags | join: ',' | downcase }}">
                                <div class="item-left">
                                    <a href="https://www.goodreads.com/book/show/{{ book.id }}" target="_blank" class="item-title hover:underline">
                                        {{ book.title }}
                                    </a>
                                    <span class="item-author">
                                        by {{ book.author }}
                                        {% if book.tags %}
                                            {% for tag in book.tags limit:3 %}
                                                <span class="tag-pill" onclick="filterByTag('{{ tag }}')">{{ tag }}</span>
                                            {% endfor %}
                                        {% endif %}
                                    </span>
                                </div>
                                <div class="item-meta">
                                    <!-- Star Rendering Loop -->
                                    <span class="stars">
                                        {% for i in (1..5) %}
                                            {% if i <= book.rating %}
                                                <span class="star-fill">●</span>
                                            {% else %}
                                                <span class="star-empty">○</span>
                                            {% endif %}
                                        {% endfor %}
                                    </span>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </details>
            {% endfor %}


            {% comment %} --- LOOP 2: UNDATED BOOKS --- {% endcomment %}
            {% if undated_books.size > 0 %}
                <details class="year-group">
                    <summary class="year-summary">
                        <div>
                            <span class="year-text">Older</span>
                            <span class="year-count">{{ undated_books.size }}</span>
                        </div>
                        <i data-lucide="chevron-down" class="chevron w-5 h-5"></i>
                    </summary>
                    <div class="group-content">
                        {% for book in undated_books %}
                            <div class="item-row book-entry" data-date="" data-rating="{{ book.rating }}" data-tags="{{ book.tags | join: ',' | downcase }}">
                                <div class="item-left">
                                    <a href="https://www.goodreads.com/book/show/{{ book.id }}" target="_blank" class="item-title hover:underline">
                                        {{ book.title }}
                                    </a>
                                    <span class="item-author">
                                        by {{ book.author }}
                                        {% if book.tags %}
                                            {% for tag in book.tags limit:3 %}
                                                <span class="tag-pill" onclick="filterByTag('{{ tag }}')">{{ tag }}</span>
                                            {% endfor %}
                                        {% endif %}
                                    </span>
                                </div>
                                <div class="item-meta">
                                    <span class="stars">
                                        {% for i in (1..5) %}
                                            {% if i <= book.rating %}
                                                <span class="star-fill">●</span>
                                            {% else %}
                                                <span class="star-empty">○</span>
                                            {% endif %}
                                        {% endfor %}
                                    </span>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </details>
            {% endif %}

        </div>
    </div>

    <!-- 
        ========================================
        4. ESSAYS VIEW (Hidden by default)
        ========================================
    -->
    <div id="viewEssays" class="hidden">
        <div class="list-header">
            <span>Title / Author</span>
            <span>Date</span>
        </div>

        {% assign articles = site.data.articles | sort: 'date' | reverse %}
        {% for article in articles %}
        <div class="item-row">
            <div class="item-left">
                <a href="{{ article.link }}" target="_blank" class="item-title hover:underline">
                    {{ article.title }}
                </a>
                <span class="item-author">{{ article.author }}</span>
            </div>
            <div class="item-meta">
                {{ article.date | date: "%Y" }}
            </div>
        </div>
        {% endfor %}
    </div>

</div>

<!-- 
    ========================================
    5. JAVASCRIPT LOGIC
    ========================================
-->
<script>
    // Ingest Jekyll data into JS
    const books = {{ site.data.books | jsonify }};
    
    // --- GLOBAL STATE ---
    let sortMode = 'date'; 
    let currentFilter = null;
    let originalHTML = ''; // Stores the initial "Date View" to restore later

    // --- DASHBOARD INIT ---
    function initDashboard() {
        // 1. Calculate Average Rating
        const ratedBooks = books.filter(b => b.rating > 0);
        const totalRating = ratedBooks.reduce((sum, b) => sum + b.rating, 0);
        const avg = (totalRating / ratedBooks.length).toFixed(1);
        document.getElementById('statAvgRating').textContent = avg;

        // 2. Prepare Chart Data (Group by Year)
        const yearMap = {};
        const currentYear = new Date().getFullYear();
        
        books.forEach(b => {
            if(b.date_read) {
                const y = new Date(b.date_read).getFullYear();
                yearMap[y] = (yearMap[y] || 0) + 1;
            }
        });

        // Update "This Year" Text
        document.getElementById('statCurrentYear').textContent = yearMap[currentYear] || 0;

        // 3. Render Bar Chart (Last 5 Years)
        const chartContainer = document.getElementById('readingChart');
        const yearsToShow = 5;
        const startYear = currentYear - yearsToShow + 1;
        
        // Find max value
        let maxCount = 0;
        for (let y = startYear; y <= currentYear; y++) {
            if ((yearMap[y] || 0) > maxCount) maxCount = yearMap[y];
        }

        // Generate HTML for bars
        let chartHTML = '';
        for (let y = startYear; y <= currentYear; y++) {
            const count = yearMap[y] || 0;
            const heightPct = maxCount > 0 ? (count / maxCount) * 100 : 0;
            const barHeight = Math.max(heightPct, 2); 
            const activeClass = y === currentYear ? 'active-year' : '';

            chartHTML += `
                <div class="bar-group">
                    <span class="bar-label">'${y.toString().slice(2)}</span>
                    <div class="bar-track">
                        <div class="bar ${activeClass}" style="width: ${barHeight}%"></div>
                    </div>
                    <span class="bar-val">${count}</span>
                </div>
            `;
        }
        chartContainer.innerHTML = chartHTML;
    }

    // --- TAB SWITCHING ---
    function switchTab(tab) {
        const booksDiv = document.getElementById('viewBooks');
        const essaysDiv = document.getElementById('viewEssays');
        const btns = document.querySelectorAll('.tab-btn');

        if(tab === 'books') {
            booksDiv.classList.remove('hidden');
            essaysDiv.classList.add('hidden');
            btns[0].classList.add('active');
            btns[1].classList.remove('active');
        } else {
            booksDiv.classList.add('hidden');
            essaysDiv.classList.remove('hidden');
            btns[1].classList.add('active');
            btns[0].classList.remove('active');
        }
    }

    // --- SORTING LOGIC ---
    function toggleSort() {
        const container = document.getElementById('bookListContainer');
        const label = document.getElementById('sortLabel');
        
        if (sortMode === 'date') {
            // SWITCH TO: BEST RATED
            sortMode = 'rating';
            label.textContent = "Best Rated";
            
            // 1. Grab all book entries (ignoring current DOM structure)
            const allEntries = Array.from(document.querySelectorAll('.book-entry'));
            
            // 2. Sort by Rating (Descending)
            allEntries.sort((a, b) => {
                const rA = parseFloat(a.getAttribute('data-rating')) || 0;
                const rB = parseFloat(b.getAttribute('data-rating')) || 0;
                // Tie-breaker: Date
                if (rA === rB) {
                    return (b.getAttribute('data-date')||'').localeCompare(a.getAttribute('data-date')||'');
                }
                return rB - rA; 
            });
            
            // 3. Render Flat List
            container.innerHTML = '';
            allEntries.forEach(entry => container.appendChild(entry));

        } else {
            // SWITCH TO: NEWEST FIRST (Restore Date View)
            sortMode = 'date';
            label.textContent = "Newest First";
            
            // Restore the Accordion Structure from memory
            container.innerHTML = originalHTML;
            
            // Re-initialize icons for the restored HTML
            if(typeof lucide !== 'undefined') lucide.createIcons();
        }

        // CRITICAL: Re-apply the current filter if one exists
        if (currentFilter) {
            filterByTag(currentFilter);
        }
    }

    // --- FILTERING LOGIC ---
    function filterByTag(tagName) {
        currentFilter = tagName;
        const cleanTag = tagName.toLowerCase().trim();
        let visibleCount = 0;

        // 1. Update UI Label
        document.getElementById('filterLabel').textContent = '#' + cleanTag;
        document.getElementById('filterStatus').classList.remove('hidden');

        // 2. Determine View Mode (Accordion vs Flat)
        const yearGroups = document.querySelectorAll('.year-group');
        const isYearMode = yearGroups.length > 0;

        if (isYearMode) {
            // --- ACCORDION MODE (Date View) ---
            yearGroups.forEach(group => {
                const rows = group.querySelectorAll('.book-entry');
                let groupHasBook = false;
                const countBubble = group.querySelector('.year-count');

                rows.forEach(row => {
                    const rowTags = row.getAttribute('data-tags') || "";
                    // Split the string into an array and check for an exact match
                    if (rowTags.split(',').includes(cleanTag)) {
                        row.classList.remove('hidden');
                        groupHasBook = true;
                        visibleCount++;
                    } else {
                        row.classList.add('hidden');
                    }
                });

                if (groupHasBook) {
                    group.classList.remove('hidden');
                    group.open = true; // Force open
                    if(countBubble) countBubble.style.display = 'none'; // Hide year count
                } else {
                    group.classList.add('hidden');
                }
            });
        } else {
            // --- FLAT MODE (Rated View) ---
            const allRows = document.querySelectorAll('.book-entry');
            allRows.forEach(row => {
                const rowTags = row.getAttribute('data-tags') || "";
                // Split and check exact match
                if (rowTags.split(',').includes(cleanTag)) { 
                    row.classList.remove('hidden');
                    visibleCount++;
                } else {
                    row.classList.add('hidden');
                }
            });
        }

        // 3. Update the Count Badge
        const countSpan = document.getElementById('filterCount');
        if(countSpan) countSpan.textContent = `(${visibleCount})`;
    }

    function clearFilter() {
        currentFilter = null;
        document.getElementById('filterStatus').classList.add('hidden');
        
        // Show all rows and groups
        document.querySelectorAll('.book-entry').forEach(el => el.classList.remove('hidden'));
        document.querySelectorAll('.year-group').forEach(el => el.classList.remove('hidden'));
        
        // Restore Year Bubbles
        document.querySelectorAll('.year-count').forEach(el => el.style.display = 'inline-block');
    }

    // --- INITIALIZE ---
    document.addEventListener('DOMContentLoaded', () => {
        initDashboard();
        
        // Save the initial HTML (Date View) so we can restore it later without reloading
        const container = document.getElementById('bookListContainer');
        if(container) originalHTML = container.innerHTML;

        if(typeof lucide !== 'undefined') lucide.createIcons();
    });
</script>
